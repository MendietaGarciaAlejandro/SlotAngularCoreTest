<div class="game-play-container">
    <!-- Navbar / Header de juego en mÃ³vil -->
    <div class="game-nav">
        <button class="back-button" (click)="goBack()">
            <i>â¬…</i> Volver
        </button>
        <div class="balance-display">
            <span class="currency">$</span>
            <span class="amount">{{ balance | number:'1.2-2' }}</span>
        </div>
    </div>

    <div class="slot-machine container" *ngIf="game && config; else loadingTemplate">
        <div class="game-header-info">
            <h2>{{ game.titulo }}</h2>
            <div class="provider-badge">{{ game.proveedor }}</div>
        </div>

        <!-- Area de Juego -->
        <div class="slot-grid" [style.background]="config.colorTema ?? '#1a1d24'">
            <div class="grid-container" [style.gridTemplateColumns]="'repeat(' + config.columnas + ', 1fr)'">
                <ng-container *ngFor="let row of grid; let r = index">
                    <div class="slot-cell" *ngFor="let symbol of row; let c = index">
                        <span class="symbol" [class.spinning]="isSpinning">{{ symbol }}</span>
                    </div>
                </ng-container>
            </div>
        </div>

        <div class="win-display" *ngIf="lastWin > 0 && !isSpinning">
            <span class="win-text">Â¡Premio: ${{ lastWin | number:'1.2-2' }}!</span>
        </div>

        <!-- Controles -->
        <div class="slot-controls">
            <div class="bet-control">
                <button class="btn btn-secondary" (click)="bet = bet > 1 ? bet - 1 : 1"
                    [disabled]="isSpinning">-</button>
                <div class="bet-display">
                    <span class="label">Apuesta</span>
                    <span class="value">${{ bet }}</span>
                </div>
                <button class="btn btn-secondary" (click)="bet = bet + 1" [disabled]="isSpinning">+</button>
            </div>

            <button class="btn btn-action spin-button" [class.spinning]="isSpinning"
                [disabled]="isSpinning || balance < bet" (click)="spin()">
                {{ isSpinning ? 'Girando...' : 'GIRAR ðŸ”„' }}
            </button>
        </div>
    </div>

    <ng-template #loadingTemplate>
        <div class="loading-state">
            <div class="spinner"></div>
            <p>Cargando juego...</p>
        </div>
    </ng-template>
</div>